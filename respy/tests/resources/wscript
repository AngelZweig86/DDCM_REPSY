def build(ctx):

    # We need to be a little more relaxed with the floating point traps when compiling the code
    # from the original paper.
    flags = ctx.env['FCFLAGS'][:]
    if ctx.env['DEBUG']:
        flags.remove('-ffpe-trap=zero,overflow,invalid')

    src = ['kw_imsl_replacements.f90', 'kw_test_additions.f90']
    for fname in ['kw_dpml4a', 'kw_dp3asim']:
        ctx(features=['fc', 'fcprogram'], source=src + [fname + '.f90'], target=fname, flags=flags)
